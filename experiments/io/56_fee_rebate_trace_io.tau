# Experiment 56a: Fee rebate trace (precomputed products)

i1 : bv[16] = in file("experiments/io/inputs/fee_rebate_fee.in")
i2 : bv[16] = in file("experiments/io/inputs/fee_rebate_rate.in")
i3 : bv[16] = in file("experiments/io/inputs/fee_rebate_rebate.in")
i4 : bv[16] = in file("experiments/io/inputs/fee_rebate_cap.in")
i5 : bv[16] = in file("experiments/io/inputs/fee_rebate_rebate_mul.in")
i6 : bv[16] = in file("experiments/io/inputs/fee_rebate_fee_rate_mul.in")

o1 : sbf = out file("experiments/io/outputs/fee_rebate_rate_ok.out")
o2 : sbf = out file("experiments/io/outputs/fee_rebate_cap_ok.out")
o3 : sbf = out file("experiments/io/outputs/fee_rebate_ok.out")

rebate_rate_ok_mul(lhs : bv[16], rhs : bv[16]) : sbf := (lhs >= rhs) && (lhs <= (rhs + { #x270F }:bv[16]))
rebate_cap_ok(fee : bv[16], rebate : bv[16], cap : bv[16]) : sbf := (rebate <= cap) && (rebate <= fee)

r (o1[t] = rebate_rate_ok_mul(i5[t], i6[t])) &&
  (o2[t] = rebate_cap_ok(i1[t], i3[t], i4[t])) &&
  (o3[t]:sbf = o1[t] & o2[t])
q
